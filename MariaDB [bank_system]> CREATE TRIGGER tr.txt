MariaDB [adarsh]> select e.*from empl e join(select dept_id,max(salary) as max_salary from empl group by dept_id) as dept_salary on 
e.dept_id=dept_salary.dept_id and e.salary=dept_salary.max_salary;
+--------+------+---------+-------------------+-----------+------------+-----------------+------------+---------------+------------+
| emp_id | name | dept_id | job_title         | salary    | hire_date  | retirement_date | manager_id | location      | category   |
+--------+------+---------+-------------------+-----------+------------+-----------------+------------+---------------+------------+
|      1 | John |       1 | Manager           |  90000.00 | 2010-06-15 | 2030-06-15      |       NULL | White Town    | Management |
|      5 | Mike |       2 | Engineer          |  75000.00 | 2021-11-15 | 2051-11-15      |       NULL | Laswpet       | Technical  |
|      6 | Emma |       3 | Managing Director | 150000.00 | 2005-07-22 | 2075-07-22      |       NULL | Rainbow Nagar | Management |
+--------+------+---------+-------------------+-----------+------------+-----------------+------------+---------------+------------+
3 rows in set (0.029 sec)



2.

MariaDB [Muktesh2]> select *from empl where manager_id is null;
+--------+-------+---------+-----------+----------+------------+-----------------+------------+---------------+----------------+
| emp_id | name  | dept_id | job_title | salary   | hire_date  | retirement_date | manager_id | location      | category       |
+--------+-------+---------+-----------+----------+------------+-----------------+------------+---------------+----------------+
|      2 | Alex  |       2 | Engineer  | 70000.00 | 2018-08-20 | 2048-08-20      |          1 | Laswpet       | Technical      |
|      4 | Sarah |       1 | Cashier   | 45000.00 | 2019-03-05 | 2049-03-05      |          1 | White Town    | Finance        |
|      3 | John  |       3 | Clerk     | 40000.00 | 2015-09-10 | 2035-09-10      |          2 | Rainbow Nagar | Administrative |
+--------+-------+---------+-----------+----------+------------+-----------------+------------+---------------+----------------+
3 rows in set (0.003 sec)


3.

MariaDB [Muktesh2]> select * from empl where dept_id = (select dept_id from department where dept_name = 'CSE') and 
TIMESTAMPDIFF (YEAR, hire_date, CURDATE() ) <= 6;
+--------+-------+---------+-----------+----------+------------+-----------------+------------+------------+----------+
| emp_id | name  | dept_id | job_title | salary   | hire_date  | retirement_date | manager_id | location   | category |
+--------+-------+---------+-----------+----------+------------+-----------------+------------+------------+----------+
|      4 | Sarah |       1 | Cashier   | 45000.00 | 2019-03-05 | 2049-03-05      |          1 | White Town | Finance  |
+--------+-------+---------+-----------+----------+------------+-----------------+------------+------------+----------+
1 row in set (0.004 sec)


4.
MariaDB [Muktesh2]> select dept_id, job_title, AVG(salary) as avg_salary from empl 
group by dept_id, job_title order by avg_salary DESC;
+---------+-------------------+---------------+
| dept_id | job_title         | avg_salary    |
+---------+-------------------+---------------+
|       3 | Managing Director | 150000.000000 |
|       1 | Manager           |  90000.000000 |
|       2 | Engineer          |  72500.000000 |
|       1 | Cashier           |  45000.000000 |
|       3 | Clerk             |  40000.000000 |
+---------+-------------------+---------------+
5 rows in set (0.025 sec)


MariaDB [Muktesh2]> select * from empl where location in ('Lawspet', 'Rainbow Nagar','White Town');
+--------+-------+---------+-------------------+-----------+------------+-----------------+------------+---------------+----------------+
| emp_id | name  | dept_id | job_title         | salary    | hire_date  | retirement_date | manager_id | location      | category       |
+--------+-------+---------+-------------------+-----------+------------+-----------------+------------+---------------+----------------+
|      1 | John  |       1 | Manager           |  90000.00 | 2010-06-15 | 2030-06-15      |       NULL | White Town    | Management     |
|      3 | John  |       3 | Clerk             |  40000.00 | 2015-09-10 | 2035-09-10      |          2 | Rainbow Nagar | Administrative |
|      4 | Sarah |       1 | Cashier           |  45000.00 | 2019-03-05 | 2049-03-05      |          1 | White Town    | Finance        |
|      6 | Emma  |       3 | Managing Director | 150000.00 | 2005-07-22 | 2075-07-22      |       NULL | Rainbow Nagar | Management     |
+--------+-------+---------+-------------------+-----------+------------+-----------------+------------+---------------+----------------+
4 rows in set (0.001 sec)


MariaDB [Muktesh2]> update empl set retirement_date = '2025-02-19' where emp_id = 2;
Query OK, 1 row affected (0.002 sec)
Rows matched: 1  Changed: 1  Warnings: 0

MariaDB [Muktesh2]> select retirement_date from empl where emp_id=2;
+-----------------+
| retirement_date |
+-----------------+
| 2025-02-19      |
+-----------------+
1 row in set (0.001 sec)





MariaDB [Muktesh2]> select * from empl where job_title = 'Clerk' and year(retirement_date) = year(CURDATE()) and 
month(retirement_date) = month(CURDATE());
+--------+-------+---------+-----------+----------+------------+-----------------+------------+------------+------------+
| emp_id | name  | dept_id | job_title | salary   | hire_date  | retirement_date | manager_id | location   | category   |
+--------+-------+---------+-----------+----------+------------+-----------------+------------+------------+------------+
|      7 | Mohan |       3 | Clerk     | 90000.00 | 2010-06-15 | 2025-02-26      |       NULL | light Town | Management |
+--------+-------+---------+-----------+----------+------------+-----------------+------------+------------+------------+
1 row in set (0.001 sec)



MariaDB [Muktesh2]> SELECT emp_id, name, job_title, hire_date,
    ->        TIMESTAMPDIFF(YEAR, hire_date, CURDATE()) AS years_of_service
    -> FROM empl
    -> WHERE (job_title = 'Cashier' AND TIMESTAMPDIFF(YEAR, hire_date, CURDATE()) >= 50)
    ->    OR (job_title = 'Manager' AND TIMESTAMPDIFF(YEAR, hire_date, CURDATE()) >= 60)
    ->    OR (job_title = 'Managing Director' AND TIMESTAMPDIFF(YEAR, hire_date, CURDATE()) >= 70);
+--------+-------+-----------+------------+------------------+
| emp_id | name  | job_title | hire_date  | years_of_service |
+--------+-------+-----------+------------+------------------+
|      8 | Rohan | Cashier   | 1970-06-15 |               54 |
+--------+-------+-----------+------------+------------------+
1 row in set (0.001 sec)



MariaDB [Muktesh2]> select * from empl where category = 'Finance' and TIMESTAMPDIFF(year,hire_date,CURDATE()) = 4;
+--------+---------+---------+-----------+----------+------------+-----------------+------------+----------+----------+
| emp_id | name    | dept_id | job_title | salary   | hire_date  | retirement_date | manager_id | location | category |
+--------+---------+---------+-----------+----------+------------+-----------------+------------+----------+----------+
|     10 | Muktesh |       3 | Cashier   | 45000.00 | 2021-02-26 | 2025-02-26      |       NULL | kalapet  | Finance  |
+--------+---------+---------+-----------+----------+------------+-----------------+------------+----------+----------+
1 row in set (0.001 sec)


9.

MariaDB [Muktesh2]> SELECT dept_id,name, job_title,
            MIN(hire_date) AS oldest_employee,
            MAX(hire_date) AS youngest_employee
     FROM empl
    GROUP BY dept_id, job_title;
+---------+-------+-------------------+-----------------+-------------------+
| dept_id | name  | job_title         | oldest_employee | youngest_employee |
+---------+-------+-------------------+-----------------+-------------------+
|       1 | Sarah | Cashier           | 2019-03-05      | 2019-03-05        |
|       1 | John  | Manager           | 2010-06-15      | 2010-06-15        |
|       2 | Alex  | Engineer          | 2018-08-20      | 2021-11-15        |
|       3 | Rohan | Cashier           | 1970-06-15      | 2021-02-26        |
|       3 | John  | Clerk             | 2010-06-15      | 2015-09-10        |
|       3 | Emma  | Managing Director | 2005-07-22      | 2005-07-22        |
+---------+-------+-------------------+-----------------+-------------------+
6 rows in set (0.001 sec)

10.
MariaDB [Muktesh2]> select emp_id,name,hire_date from empl where day(hire_date) = day(CURDATE()) and month(hire_date)
 = month(curdate());
+--------+---------+------------+
| emp_id | name    | hire_date  |
+--------+---------+------------+
|      9 | Adarsh  | 2020-02-26 |
|     10 | Muktesh | 2021-02-26 |
+--------+---------+------------+
2 rows in set (0.001 sec)

MariaDB [Muktesh2]> select dept_id,category,year(hire_date) as hire_year, count(*) as empl_count from empl 
group by category, hire_year order by hire_year desc;
+---------+----------------+-----------+------------+
| dept_id | category       | hire_year | empl_count |
+---------+----------------+-----------+------------+
|       2 | Technical      |      2021 |          1 |
|       3 | Finance        |      2021 |          1 |
|       3 | Finance        |      2020 |          1 |
|       1 | Finance        |      2019 |          1 |
|       2 | Technical      |      2018 |          1 |
|       3 | Administrative |      2015 |          1 |
|       1 | Management     |      2010 |          2 |
|       3 | Management     |      2005 |          1 |
|       3 | Finance        |      1970 |          1 |
+---------+----------------+-----------+------------+
9 rows in set (0.001 sec)

12.

MariaDB [Muktesh2]> SELECT
    ->     p.dept_id,
    ->     p.job_title,
    ->     p.total_position,
    ->     IFNULL(e.emp_count, 0) AS filled_positions,
    ->     (p.total_position - IFNULL(e.emp_count, 0)) AS vacancies
    -> FROM positions p
    -> LEFT JOIN (
    ->     SELECT dept_id, job_title, COUNT(*) AS emp_count
    ->     FROM empl
    ->     GROUP BY dept_id, job_title
    -> ) e
    -> ON p.dept_id = e.dept_id AND p.job_title = e.job_title
    -> ORDER BY p.dept_id, p.job_title;
+---------+-----------------+----------------+------------------+-----------+
| dept_id | job_title       | total_position | filled_positions | vacancies |
+---------+-----------------+----------------+------------------+-----------+
|       1 | Cashier         |              7 |                1 |         6 |
|       1 | Clerk           |             10 |                0 |        10 |
|       1 | Manager         |              5 |                1 |         4 |
|       2 | Engineer        |              6 |                2 |         4 |
|       2 | Technician      |              8 |                0 |         8 |
|       3 | Accountant      |              5 |                0 |         5 |
|       3 | Supervisor      |              4 |                0 |         4 |
|       4 | HR              |              3 |                0 |         3 |
|       4 | Sales Executive |              6 |                0 |         6 |
+---------+-----------------+----------------+------------------+-----------+
9 rows in set (0.001 sec)